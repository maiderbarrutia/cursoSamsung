<h1>Listado de personas</h1>
<form class="person-form" [formGroup]="form">
  <legend>Añade una persona</legend>
  <!-- Nombre -->
  <mat-form-field class="form-field" appearance="fill">
    <mat-label>Nombre:</mat-label>
    <input
      matInput
      type="text"
      placeholder="nombre"
      value="nombre"
      formControlName="nombre"
      minlength="3"
      required
      #nombre
    />
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['nombre'].invalid &&
        (form.controls['nombre'].dirty || form.controls['nombre'].touched)
      "
    >
      <div *ngIf="form.controls['nombre'].hasError('required')">
        El campo nombre es obligatorio.
      </div>
      <div *ngIf="form.controls['nombre'].hasError('minlength')">
        El campo nombre debe tener al menos 3 caracteres.
      </div>
    </mat-error>
  </mat-form-field>
  <!-- Apellidos -->
  <mat-form-field class="form-field" appearance="fill">
    <mat-label>Apellidos:</mat-label>
    <input
      matInput
      type="text"
      placeholder="apellidos"
      value="apellidos"
      formControlName="apellidos"
      minlength="3"
      required
      #apellidos
    />
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['apellidos'].invalid &&
        (form.controls['apellidos'].dirty || form.controls['apellidos'].touched)
      "
    >
      <div *ngIf="form.controls['apellidos'].hasError('required')">
        El campo apellidos es obligatorio.
      </div>
      <div *ngIf="form.controls['apellidos'].hasError('minlength')">
        El campo apellidos debe tener al menos 3 caracteres.
      </div>
    </mat-error>
  </mat-form-field>
  <!-- Edad -->
  <mat-form-field class="form-field" appearance="fill">
    <mat-label>Edad:</mat-label>
    <input
      matInput
      type="number"
      formControlName="edad"
      placeholder="Edad"
      min="0"
      max="125"
      required
      #edad
    />
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['edad'].invalid &&
        (form.controls['edad'].dirty || form.controls['edad'].touched)
      "
    >
      <div *ngIf="form.controls['edad'].hasError('required')">
        El campo edad es obligatorio.
      </div>
      <div *ngIf="form.controls['edad'].hasError('min')">
        La edad mínima debe de ser 0
      </div>
      <div *ngIf="form.controls['edad'].hasError('max')">
        La edad máxima debe de ser 125
      </div>
    </mat-error>
  </mat-form-field>
  <!-- DNI -->
  <mat-form-field class="form-field" appearance="fill">
    <mat-label>DNI:</mat-label>
    <input
      matInput
      type="text"
      placeholder="DNI"
      value="dni"
      formControlName="dni"
      maxlength="9"
      required
      #dni
    />
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['dni'].invalid &&
        (form.controls['dni'].dirty || form.controls['dni'].touched)
      "
    >
      <div *ngIf="form.controls['dni'].hasError('required')">
        El campo DNI es obligatorio.
      </div>
      <div *ngIf="form.controls['dni'].hasError('maxlength')">
        El campo DNI debe tener un máximo de 9 caracteres.
      </div>
    </mat-error>
  </mat-form-field>
  <!-- Cumpleaños -->
  <mat-form-field class="form-field" appearance="fill">
    <mat-label>Fecha de nacimiento:</mat-label>
    <input
      matInput
      type="date"
      placeholder="Cumpleaños"
      formControlName="cumpleanios"
      minlength="3"
      required
      #cumpleanios
    />
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['cumpleanios'].invalid &&
        (form.controls['cumpleanios'].dirty ||
          form.controls['cumpleanios'].touched)
      "
    >
      <div *ngIf="form.controls['cumpleanios'].hasError('required')">
        El campo Cumpleaños es obligatorio.
      </div>
    </mat-error>
  </mat-form-field>
  <!-- Color favorito -->
  <mat-form-field class="form-field" appearance="fill">
    <mat-label>Color favorito:</mat-label>
    <input
      matInput
      type="color"
      formControlName="colorFavorito"
      minlength="3"
      required
      #colorFavorito
    />
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['colorFavorito'].invalid &&
        (form.controls['colorFavorito'].dirty ||
          form.controls['colorFavorito'].touched)
      "
    >
      <div *ngIf="form.controls['colorFavorito'].hasError('required')">
        El campo Color favorito es obligatorio.
      </div>
      <div *ngIf="form.controls['colorFavorito'].hasError('minlength')">
        El campo Color favorito debe tener al menos 3 caracteres.
      </div>
    </mat-error>
  </mat-form-field>
  <!-- Género -->
  <mat-form-field appearance="fill">
    <mat-label>Género</mat-label>
    <mat-select formControlName="genero" required #genero>
      <mat-option>Selecciona un género</mat-option>
      <!-- En mat-option deberia poner [value]="i" pero luego al pintarlo me pinta el index en vez de el contenido -->
      <mat-option
        *ngFor="let gender of genderSelect(); let i = index"
        [attr.data-index]="i"
        [value]="gender"
        >{{ gender }}</mat-option
      >
    </mat-select>
    <mat-error
      [ngStyle]="{ color: 'red' }"
      *ngIf="
        form.controls['genero'].invalid &&
        (form.controls['genero'].dirty || form.controls['genero'].touched)
      "
    >
      <div *ngIf="form.controls['genero'].hasError('required')">
        El campo género es obligatorio.
      </div>
    </mat-error>
  </mat-form-field>
  <!-- Botones -->
  <div id="form-buttons" #formButtons>
    <button
      mat-button
      type="submit"
      (click)="addPerson()"
      color="primary"
      [disabled]="!form.valid"
    >
      Añadir persona
    </button>

    <button mat-button type="submit" color="primary" [disabled]="!form.valid">
      Enviar
    </button>
  </div>
  <div id="updated-buttons" #updatedButtons>
    <!-- <button
      mat-button
      type="submit"
      color="primary"
      [disabled]="!form.valid"
      (click)="updatePerson(person)"
    >
      Modificar
    </button> -->

    <button
      mat-button
      type="submit"
      color="primary"
      [disabled]="!form.valid"
      (click)="cancelUpdatePerson()"
    >
      Cancelar
    </button>
  </div>
</form>
<!-- Lista de personas -->
<table mat-table [dataSource]="dataSource" class="mat-elevation-z8 demo-table">
  <!-- Nombre -->
  <ng-container matColumnDef="nombre">
    <th mat-header-cell *matHeaderCellDef>Nombre</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">{{ person.nombre }}</p>
    </td>
  </ng-container>
  <!-- Apellidos -->
  <ng-container matColumnDef="apellidos">
    <th mat-header-cell *matHeaderCellDef>Apellidos</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">{{ person.apellidos }}</p>
    </td>
  </ng-container>

  <!-- Edad -->
  <ng-container matColumnDef="edad">
    <th mat-header-cell *matHeaderCellDef>Edad</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">{{ person.edad }}</p>
    </td>
  </ng-container>

  <!-- DNI -->
  <ng-container matColumnDef="dni">
    <th mat-header-cell *matHeaderCellDef>DNI</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">{{ person.dni }}</p>
    </td>
  </ng-container>

  <!-- Fecha cumpleaños -->
  <ng-container matColumnDef="cumpleanios">
    <th mat-header-cell *matHeaderCellDef>Cumpleaños</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">
        {{ person.cumpleanios }}
      </p>
    </td>
  </ng-container>

  <!-- Color favorito -->
  <ng-container matColumnDef="colorFavorito">
    <th mat-header-cell *matHeaderCellDef>Color</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">
        {{ person.colorFavorito }}
      </p>
    </td>
  </ng-container>

  <!-- Género -->
  <ng-container matColumnDef="genero">
    <th mat-header-cell *matHeaderCellDef>Género</th>
    <td mat-cell *matCellDef="let person; let i = index">
      <p *ngFor="let person of people; let i = index">{{ person.genero }}</p>
    </td>
  </ng-container>

  <button
    mat-button
    type="submit"
    color="primary"
    *ngFor="let person of people; let i = index"
    (click)="editPerson(person, i)"
  >
    Editar
  </button>
  <button
    mat-button
    type="submit"
    color="primary"
    *ngFor="let person of people; let i = index"
    (click)="deletePerson(person, i)"
  >
    <!-- <button
          mat-button
          type="submit"
          color="primary"
          (click)="(click)="people.splice(i, 1)""
        > -->
    Eliminar
  </button>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
</table>
